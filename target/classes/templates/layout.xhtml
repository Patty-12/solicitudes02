<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">

<h:head>
    <title><ui:insert name="titulo">Panel principal</ui:insert></title>
    <h:outputStylesheet library="css" name="estilo.css" />
</h:head>

<h:body>

<div class="dashboard">

    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar">

        <!-- TÍTULO LATERAL SIN LOGO -->
        <div class="sidebar-header">
            <h3 style="font-size: 18px; font-weight: 700; line-height: 1.2;">
                Solicitud de Permisos
            </h3>
        </div>

        <!-- MENÚ LATERAL -->
        <nav class="sidebar-nav">
            <ul id="menu">

                <!-- OPCIONES COMUNES (TODOS LOS USUARIOS) -->
                <li><h:link outcome="/home" value="Inicio" /></li>
                <li><h:link outcome="/Solicitud/index" value="Solicitudes" /></li>

                <!-- RESPONSABLE DE ACCESOS -->
                <h:panelGroup rendered="#{fn:toLowerCase(loginBean.usuario.cargo) eq 'responsable accesos'}">
                    <li>
                        <h:link outcome="/Solicitud/pendientesAccesos"
                                value="Solicitudes por aplicar" />
                    </li>
                    <li>
                        <h:link outcome="/Reportes/index"
                                value="Reportes de accesos aplicados" />
                    </li>
                </h:panelGroup>

                <!-- DIRECTOR -->
                <h:panelGroup rendered="#{fn:toLowerCase(loginBean.usuario.cargo) eq 'director'}">
                    <li>
                        <h:link outcome="/Solicitud/pendientes"
                                value="Solicitudes Pendientes" />
                    </li>
                    <li>
                        <h:link outcome="/Reportes/index"
                                value="Reportes" />
                    </li>
                </h:panelGroup>

                <!-- DIRECTOR TIC (que hoy también actúa como Oficial de Seguridad) -->
                <h:panelGroup rendered="#{fn:toLowerCase(loginBean.usuario.cargo) eq 'director tic'}">
                    <li>
                        <h:link outcome="/Solicitud/pendientes"
                                value="Solicitudes Pendientes" />
                    </li>

                    <!-- Reportes vista Dirección TIC -->
                    <li>
                        <h:link outcome="/Reportes/index"
                                value="Reportes Dirección TIC">
                            <f:param name="tipo" value="tic" />
                        </h:link>
                    </li>

                    <!-- Reportes vista Oficial de Seguridad (misma persona, otra perspectiva) -->
                    <li>
                        <h:link outcome="/Reportes/index"
                                value="Reportes Oficial Seguridad">
                            <f:param name="tipo" value="oficial" />
                        </h:link>
                    </li>
                </h:panelGroup>

                <!-- ADMINISTRADOR -->
                <h:panelGroup rendered="#{fn:toLowerCase(loginBean.usuario.cargo) eq 'administrador'}">
                    <li><h:link outcome="/Usuario/index" value="Gestión de Usuarios" /></li>
                    <li><h:link outcome="/UsuarioRol/index" value="Asignación de Rol" /></li>
                    <li><h:link outcome="/Aplicacion/index" value="Gestión de Aplicaciones" /></li>
                    <li><h:link outcome="/PermisoAplicacion/index" value="Permisos de Aplicaciones" /></li>
                    <li><h:link outcome="/Auditoria/index" value="Auditoría del Sistema" /></li>
              <!--  <li><h:link outcome="/Reportes/index" value="Reportes del Sistema" /></li>  -->
                </h:panelGroup>

            </ul>
        </nav>

        <!-- BOTÓN CERRAR SESIÓN -->
        <div class="sidebar-logout">
            <h:form id="logoutForm">
                <h:commandButton id="logoutBtn"
                                 value="Cerrar Sesión"
                                 action="#{loginBean.logout}"
                                 styleClass="btn-logout"
                                 ajax="false" />
            </h:form>
        </div>

    </aside>

    <!-- ===== CONTENIDO PRINCIPAL ===== -->
    <main class="main-content">

        <!-- HEADER: LOGO NUEVO + BIENVENIDA -->
        <header class="main-header">

            <!-- Logo institucional nuevo -->
            <h:graphicImage library="img"
                            name="logo.jpeg"
                            styleClass="main-header-logo"
                            alt="Logo institucional" />

            <!-- Texto de usuario -->
            <div class="main-header-user">
                <h2>
                    Bienvenido,
                    #{loginBean.usuario.nombre}
                    #{loginBean.usuario.apellido}
                </h2>

                <p>
                    Correo: #{loginBean.usuario.correo}
                    <span style="margin: 0 10px;">·</span>
                    Cargo: #{loginBean.usuario.cargo}
                </p>
            </div>

        </header>

        <!-- CONTENIDO VARIABLE -->
        <section class="content">
            <ui:insert name="contenido" />
        </section>

    </main>

</div>

</h:body>
</html>
