<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">

<h:head>
    <title><ui:insert name="titulo">Panel principal</ui:insert></title>
    <h:outputStylesheet library="css" name="style.css" />
</h:head>

<h:body>

<div class="dashboard">

    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar">

        <!-- LOGO Y TÍTULO -->
        <div class="sidebar-header">
            <h:graphicImage library="img" name="logo.png"
                            styleClass="sidebar-logo"
                            alt="Logo" />
            <h3>Sistema de Solicitudes</h3>
        </div>

        <!-- ===== MENÚ LATERAL ===== -->
        <nav class="sidebar-nav">
            <ul id="menu">

                <!-- TODOS: Inicio -->
                <li>
                    <h:link outcome="/home" value="Inicio" />
                </li>

                <!-- TODOS: Solicitudes -->
                <li>
                    <h:link outcome="/Solicitud/index" value="Solicitudes" />
                </li>

                <!-- ===== DIRECTOR (de área) ===== -->
                <h:panelGroup rendered="#{loginBean.usuario.cargo eq 'Director' or loginBean.usuario.cargo eq 'director'}">

                    <li>
                        <h:link outcome="/Solicitud/pendientes" value="Solicitudes Pendientes" />
                    </li>

                    <li>
                        <h:link outcome="/Reportes/index" value="Reportes" />
                    </li>

                </h:panelGroup>

                <!-- ===== DIRECTOR TIC ===== -->
                <h:panelGroup rendered="#{loginBean.usuario.cargo ne null and fn:contains(fn:toLowerCase(loginBean.usuario.cargo), 'tic')}">

                    <li>
                        <h:link outcome="/Solicitud/pendientes" value="Solicitudes Pendientes" />
                    </li>

                    <li>
                        <h:link outcome="/Reportes/index" value="Reportes" />
                    </li>

                </h:panelGroup>

                <!-- ===== OFICIAL DE SEGURIDAD ===== -->
                <h:panelGroup rendered="#{loginBean.usuario.cargo ne null and fn:contains(fn:toLowerCase(loginBean.usuario.cargo), 'oficial')}">

                    <li>
                        <h:link outcome="/Solicitud/pendientes" value="Solicitudes Pendientes" />
                    </li>

                </h:panelGroup>

                <!-- ===== ADMINISTRADOR ===== -->
                <h:panelGroup rendered="#{loginBean.usuario.cargo eq 'Administrador'}">

                    <li>
                        <h:link outcome="/Usuario/index" value="Gestión de Usuarios" />
                    </li>

                    <li>
                        <h:link outcome="/Rol/index" value="Catálogo de Roles" />
                    </li>

                    <li>
                        <h:link outcome="/UsuarioRol/index" value="Asignación Usuario–Rol" />
                    </li>

                    <li>
                        <h:link outcome="/Aplicacion/index" value="Gestión de Aplicaciones" />
                    </li>

                    <li>
                        <h:link outcome="/PermisoAplicacion/index" value="Permisos de Aplicaciones" />
                    </li>

                    <li>
                        <h:link outcome="/Auditoria/index" value="Auditoría del Sistema" />
                    </li>

                    <li>
                        <h:link outcome="/Reportes/index" value="Reportes" />
                    </li>

                </h:panelGroup>

            </ul>
        </nav>

        <!-- BOTÓN LOGOUT -->
        <h:form id="logoutForm">
            <h:commandButton id="logoutBtn"
                             value="Cerrar Sesión"
                             action="#{loginBean.logout}"
                             styleClass="btn-logout"
                             ajax="false" />
        </h:form>

    </aside>

    <!-- ===== CONTENIDO PRINCIPAL ===== -->
    <main class="main-content">

        <!-- ENCABEZADO SUPERIOR -->
        <header class="main-header">
            <h2>
                Bienvenido,
                #{loginBean.usuario.nombre}
                #{loginBean.usuario.apellido}
            </h2>

            <p>
                Correo: #{loginBean.usuario.correo}
                <span style="margin: 0 10px;">·</span>
                Cargo: #{loginBean.usuario.cargo}
            </p>
        </header>

        <!-- CONTENIDO VARIABLE DE CADA PÁGINA -->
        <section class="content">
            <ui:insert name="contenido">
                <div class="card">
                    <h3>Resumen General</h3>
                    <p>El contenido se ajustará según el rol del usuario.</p>
                </div>
            </ui:insert>
        </section>

    </main>

</div>

</h:body>
</html>
